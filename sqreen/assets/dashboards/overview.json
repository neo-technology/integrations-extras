{
    "title":"Application Security Dashboard (formerly Sqreen)",
    "description":null,
    "widgets":[
       {
          "id":5430546063815500,
          "definition":{
             "title":"Datadog Application Security (formerly Sqreen) - Alpha",
             "type":"group",
             "background_color":"vivid_purple",
             "show_title":true,
             "layout_type":"ordered",
             "widgets":[
                {
                   "id":4440621954431120,
                   "definition":{
                      "type":"image",
                      "url":"https://www.sqreen.com/assets/img/logos/datadog-sqreen.jpg",
                      "sizing":"contain",
                      "margin":"md",
                      "has_background":false,
                      "has_border":false,
                      "vertical_align":"center",
                      "horizontal_align":"center"
                   },
                   "layout":{
                      "x":0,
                      "y":0,
                      "width":1,
                      "height":1
                   }
                },
                {
                   "id":2724225582370954,
                   "definition":{
                      "type":"note",
                      "content":"This Dashboard presents the key insights detected on the Sqreen platform and sent to Datadog.\nIt helps security and engineering teams monitor attacks, attackers and vulnerability exploits.",
                      "background_color":"transparent",
                      "font_size":"16",
                      "text_align":"left",
                      "vertical_align":"center",
                      "show_tick":false,
                      "tick_pos":"50%",
                      "tick_edge":"left",
                      "has_padding":false
                   },
                   "layout":{
                      "x":1,
                      "y":0,
                      "width":3,
                      "height":1
                   }
                },
                {
                   "id":3311623709071802,
                   "definition":{
                      "title":"Attacks",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"query_value",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ]
                         }
                      ],
                      "autoscale":true,
                      "custom_unit":"",
                      "precision":0
                   },
                   "layout":{
                      "x":4,
                      "y":0,
                      "width":3,
                      "height":2
                   }
                },
                {
                   "id":6737776741007026,
                   "definition":{
                      "type":"note",
                      "content":"\\>>",
                      "background_color":"white",
                      "font_size":"56",
                      "text_align":"center",
                      "vertical_align":"center",
                      "show_tick":false,
                      "tick_pos":"50%",
                      "tick_edge":"left",
                      "has_padding":true
                   },
                   "layout":{
                      "x":7,
                      "y":0,
                      "width":2,
                      "height":2
                   }
                },
                {
                   "id":6879193883014476,
                   "definition":{
                      "title":"Blocked attacks",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"query_value",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack @appsec.protection.triggered_blocking:true $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ]
                         }
                      ],
                      "autoscale":true,
                      "precision":0
                   },
                   "layout":{
                      "x":9,
                      "y":0,
                      "width":3,
                      "height":2
                   }
                },
                {
                   "id":6631602501457938,
                   "definition":{
                      "type":"note",
                      "content":"**Quick navigation:** \n* [AppSec Explorer](https://app.datadoghq.com/security/appsec/list \"{isExternal}\")\n* [Sqreen Incidents](https://my.sqreen.com/incidents?duration=2592000 \"{isExternal}\")",
                      "background_color":"white",
                      "font_size":"12",
                      "text_align":"left",
                      "vertical_align":"top",
                      "show_tick":false,
                      "tick_pos":"50%",
                      "tick_edge":"left",
                      "has_padding":true
                   },
                   "layout":{
                      "x":0,
                      "y":1,
                      "width":4,
                      "height":1
                   }
                }
             ]
          },
          "layout":{
             "x":0,
             "y":0,
             "width":12,
             "height":3
          }
       },
       {
          "id":5709155062516524,
          "definition":{
             "title":"Security Activity Overview",
             "type":"group",
             "background_color":"purple",
             "show_title":true,
             "layout_type":"ordered",
             "widgets":[
                {
                   "id":5896019122845258,
                   "definition":{
                      "title":"Attacks detected",
                      "title_size":"16",
                      "title_align":"left",
                      "show_legend":false,
                      "legend_layout":"vertical",
                      "legend_columns":[
                         "value",
                         "sum"
                      ],
                      "type":"timeseries",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "alias":"Attacks detected",
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"timeseries",
                            "on_right_yaxis":false,
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ],
                            "style":{
                               "palette":"dog_classic",
                               "line_type":"solid",
                               "line_width":"normal"
                            },
                            "display_type":"line"
                         }
                      ],
                      "yaxis":{
                         "include_zero":false
                      },
                      "markers":[

                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":0,
                      "width":6,
                      "height":2
                   }
                },
                {
                   "id":3539058106633928,
                   "definition":{
                      "title":"Authenticated attacks detected",
                      "title_size":"16",
                      "title_align":"left",
                      "show_legend":true,
                      "legend_layout":"horizontal",
                      "legend_columns":[
                         "value",
                         "sum"
                      ],
                      "type":"timeseries",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "alias":"Authenticated attacks detected",
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"timeseries",
                            "on_right_yaxis":false,
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack @usr.id:* $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@appsec.detection.type",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ],
                            "style":{
                               "palette":"dog_classic",
                               "line_type":"solid",
                               "line_width":"normal"
                            },
                            "display_type":"bars"
                         }
                      ],
                      "yaxis":{
                         "include_zero":false
                      },
                      "markers":[

                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":2,
                      "width":6,
                      "height":2
                   }
                },
                {
                   "id":4317467133901640,
                   "definition":{
                      "title":"Vulnerability Exploits",
                      "title_size":"16",
                      "title_align":"left",
                      "show_legend":true,
                      "legend_layout":"horizontal",
                      "legend_columns":[
                         "avg",
                         "min",
                         "max",
                         "value",
                         "sum"
                      ],
                      "type":"timeseries",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"timeseries",
                            "on_right_yaxis":false,
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.vulnerability_exploit $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@appsec.detection.type",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ],
                            "style":{
                               "palette":"warm",
                               "line_type":"solid",
                               "line_width":"normal"
                            },
                            "display_type":"bars"
                         }
                      ],
                      "yaxis":{
                         "include_zero":true,
                         "scale":"linear",
                         "label":"",
                         "min":"auto",
                         "max":"auto"
                      },
                      "markers":[

                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":4,
                      "width":6,
                      "height":2
                   }
                }
             ]
          },
          "layout":{
             "x":0,
             "y":0,
             "width":6,
             "height":7
          }
       },
       {
          "id":1916950398822620,
          "definition":{
             "title":"Bad Actor Monitoring",
             "type":"group",
             "background_color":"purple",
             "show_title":true,
             "layout_type":"ordered",
             "widgets":[
                {
                   "id":4771457912980518,
                   "definition":{
                      "title":"IP Attacking - Top 10",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"toplist",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1",
                                  "limit":{
                                     "count":5,
                                     "order":"desc"
                                  }
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@network.client.ip",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ]
                         }
                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":0,
                      "width":3,
                      "height":2
                   }
                },
                {
                   "id":8603516909075678,
                   "definition":{
                      "title":"Authenticated Attackers - Top 10",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"toplist",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1",
                                  "limit":{
                                     "count":5,
                                     "order":"desc"
                                  }
                               }
                            ],
                            "conditional_formats":[
                               {
                                  "comparator":">",
                                  "palette":"white_on_red",
                                  "value":20
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@usr.id",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ]
                         }
                      ]
                   },
                   "layout":{
                      "x":3,
                      "y":0,
                      "width":3,
                      "height":2
                   }
                },
                {
                   "id":7942545483792642,
                   "definition":{
                      "title":"User logins",
                      "title_size":"16",
                      "title_align":"left",
                      "show_legend":true,
                      "legend_layout":"horizontal",
                      "legend_columns":[
                         "avg",
                         "min",
                         "max",
                         "value",
                         "sum"
                      ],
                      "type":"timeseries",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "alias":"Login success",
                                  "formula":"query1"
                               }
                            ],
                            "response_format":"timeseries",
                            "on_right_yaxis":false,
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.authentication.sign_in @evt.outcome:success $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ],
                            "style":{
                               "palette":"green",
                               "line_type":"solid",
                               "line_width":"normal"
                            },
                            "display_type":"bars"
                         },
                         {
                            "formulas":[
                               {
                                  "alias":"Login failure",
                                  "formula":"query0"
                               }
                            ],
                            "response_format":"timeseries",
                            "on_right_yaxis":false,
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.authentication.sign_in @evt.outcome:failure $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query0",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ],
                            "style":{
                               "palette":"warm",
                               "line_type":"solid",
                               "line_width":"normal"
                            },
                            "display_type":"bars"
                         }
                      ],
                      "yaxis":{
                         "include_zero":true,
                         "scale":"linear",
                         "label":"",
                         "min":"auto",
                         "max":"auto"
                      },
                      "markers":[

                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":2,
                      "width":6,
                      "height":2
                   }
                },
                {
                   "id":6550606525168926,
                   "definition":{
                      "title":"Top attacking countries",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"geomap",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1",
                                  "limit":{
                                     "count":250,
                                     "order":"desc"
                                  }
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@network.client.geoip.country.iso_code",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":1000
                                     }
                                  ]
                               }
                            ]
                         }
                      ],
                      "style":{
                         "palette":"YlOrRd",
                         "palette_flip":false
                      },
                      "view":{
                         "focus":"WORLD"
                      }
                   },
                   "layout":{
                      "x":0,
                      "y":4,
                      "width":6,
                      "height":2
                   }
                }
             ]
          },
          "layout":{
             "x":6,
             "y":0,
             "width":6,
             "height":7
          }
       },
       {
          "id":5676996710684674,
          "definition":{
             "title":"Web Services Security Monitoring",
             "type":"group",
             "background_color":"purple",
             "show_title":true,
             "layout_type":"ordered",
             "widgets":[
                {
                   "id":7236029092397330,
                   "definition":{
                      "title":"Web services targeted - Top 10",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"toplist",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1",
                                  "limit":{
                                     "count":10,
                                     "order":"desc"
                                  }
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"service",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ]
                         }
                      ]
                   },
                   "layout":{
                      "x":0,
                      "y":0,
                      "width":6,
                      "height":4
                   }
                },
                {
                   "id":7024397760759730,
                   "definition":{
                      "title":"Top Targeted Service/Path",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"query_table",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "alias":"All Attacks",
                                  "conditional_formats":[

                                  ],
                                  "limit":{
                                     "count":1000,
                                     "order":"desc"
                                  },
                                  "cell_display_mode":"bar",
                                  "formula":"query1"
                               },
                               {
                                  "alias":"Authenticated Attacks",
                                  "conditional_formats":[

                                  ],
                                  "cell_display_mode":"bar",
                                  "formula":"query2"
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@http.url_details.path",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     },
                                     {
                                        "facet":"service",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     },
                                     {
                                        "facet":"@appsec.detection.type",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               },
                               {
                                  "search":{
                                     "query":"@evt.category:appsec.threat.attack @usr.id:* $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"app_sec_events",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query2",
                                  "indexes":[
                                     "*"
                                  ],
                                  "group_by":[
                                     {
                                        "facet":"@http.url_details.path",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     },
                                     {
                                        "facet":"service",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     },
                                     {
                                        "facet":"@appsec.detection.type",
                                        "sort":{
                                           "aggregation":"count",
                                           "order":"desc"
                                        },
                                        "limit":10
                                     }
                                  ]
                               }
                            ]
                         }
                      ],
                      "has_search_bar":"auto"
                   },
                   "layout":{
                      "x":6,
                      "y":0,
                      "width":6,
                      "height":4
                   }
                }
             ]
          },
          "layout":{
             "x":0,
             "y":0,
             "width":12,
             "height":5,
             "is_column_break":true
          }
       },
       {
          "id":4910705320357042,
          "definition":{
             "title":"Configuration",
             "type":"group",
             "background_color":"gray",
             "show_title":true,
             "layout_type":"ordered",
             "widgets":[
                {
                   "id":3736025714565854,
                   "definition":{
                      "title":"Number of spans with AppSec Events indexed",
                      "title_size":"16",
                      "title_align":"left",
                      "type":"query_value",
                      "requests":[
                         {
                            "formulas":[
                               {
                                  "formula":"query1"
                               }
                            ],
                            "conditional_formats":[
                               {
                                  "comparator":"<",
                                  "palette":"white_on_red",
                                  "value":1
                               }
                            ],
                            "response_format":"scalar",
                            "queries":[
                               {
                                  "search":{
                                     "query":"@sqreen.event:true $Service $Env $IPAddress $Country $User"
                                  },
                                  "data_source":"spans",
                                  "compute":{
                                     "aggregation":"count"
                                  },
                                  "name":"query1",
                                  "indexes":[
                                     "trace-search"
                                  ],
                                  "group_by":[

                                  ]
                               }
                            ]
                         }
                      ],
                      "autoscale":true,
                      "precision":0
                   },
                   "layout":{
                      "x":0,
                      "y":0,
                      "width":5,
                      "height":2
                   }
                },
                {
                   "id":2953024280621026,
                   "definition":{
                      "type":"note",
                      "content":"If this widget doesn't show any data, your setup can likely be enhanced. To ensure all traces where attacks are detected are being retained, please follow the following process: \n\n* Update your Sqreen library to the latest version - [Documentation](https://docs.sqreen.com/ \"{isExternal}\")\n* Create a retention filter to retain 100% of the indexed spans matching this query `@sqreen.event:true` - [Retention filters](https://app.datadoghq.com/apm/traces/retention-filters \"{isExternal}\")",
                      "background_color":"yellow",
                      "font_size":"14",
                      "text_align":"left",
                      "vertical_align":"center",
                      "show_tick":true,
                      "tick_pos":"50%",
                      "tick_edge":"left",
                      "has_padding":true
                   },
                   "layout":{
                      "x":5,
                      "y":0,
                      "width":7,
                      "height":2
                   }
                }
             ]
          },
          "layout":{
             "x":0,
             "y":5,
             "width":12,
             "height":3
          }
       }
    ],
    "template_variables":[
       {
          "name":"Service",
          "default":"*",
          "prefix":"service"
       },
       {
          "name":"Env",
          "default":"*",
          "prefix":"env"
       },
       {
          "name":"IPAddress",
          "default":"*",
          "prefix":"@network.client.ip"
       },
       {
          "name":"Country",
          "default":"*",
          "prefix":"@network.client.geoip.country.name"
       },
       {
          "name":"User",
          "default":"*",
          "prefix":"@usr.id"
       }
    ],
    "layout_type":"ordered",
    "is_read_only":false,
    "notify_list":[

    ],
    "template_variable_presets":[
       {
          "name":"Production",
          "template_variables":[
             {
                "name":"Env",
                "value":"production"
             }
          ]
       }
    ],
    "reflow_type":"fixed",
    "id":"wjc-ehj-2vm"
 }

